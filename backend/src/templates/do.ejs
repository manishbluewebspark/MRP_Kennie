<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Delivery Order - <%= doNo %></title>
  <style>
    * { box-sizing: border-box; font-family: Arial, Helvetica, sans-serif; }
    body { margin: 0; color: #111; font-size: 12px; }
    .page { padding: 10mm; }

    /* Header + Footer fixed for print */
    @page { size: A4; margin: 15mm 10mm 18mm 10mm; }
    header { position: fixed; top: -12mm; left: 0; right: 0; }
    footer { position: fixed; bottom: -15mm; left: 0; right: 0; font-size: 11px; }

    .brand-row { display: flex; justify-content: space-between; align-items: flex-start; gap: 16px; }
    .brand-block { width: 60%; }
    .brand-title { font-size: 18px; font-weight: 700; letter-spacing: .2px; }
    .brand-meta { margin-top: 4px; line-height: 1.4; }

    .doc-meta { width: 40%; border: 1px solid #e5e5e5; padding: 8px; }
    .doc-meta table { width: 100%; border-collapse: collapse; }
    .doc-meta td { padding: 4px 6px; border-bottom: 1px dashed #ddd; }
    .doc-meta td:first-child { width: 35%; color: #666; }

    .two-col { display: flex; gap: 14px; margin-top: 10px; }
    .card { border: 1px solid #e5e5e5; padding: 8px; flex: 1; }
    .card .t { color: #666; margin-bottom: 6px; font-weight: 600; }
    .card .v { white-space: pre-line; }

    .title { margin: 10px 0 6px; font-size: 14px; font-weight: 700; text-transform: uppercase; }

    table.items { width: 100%; border-collapse: collapse; }
    table.items th, table.items td { border: 1px solid #ddd; padding: 6px; }
    table.items th { background: #f4f6f8; text-align: left; }
    table.items td.center, table.items th.center { text-align: center; }
    table.items td.right,  table.items th.right  { text-align: right; }

    /* Sticky header row across pages */
    thead { display: table-header-group; }
    tfoot { display: table-footer-group; }

    .sign-row { display: flex; justify-content: space-between; margin-top: 14mm; }
    .sign-box { width: 48%; text-align: center; }
    .line { margin-top: 18mm; border-top: 1px solid #333; padding-top: 4px; }

    footer .footline { border-top: 1px solid #ddd; padding-top: 6px; color: #666; display:flex; justify-content:space-between; }
  </style>
</head>
<body>
<header>
  <div class="page">
    <div class="brand-row">
      <div class="brand-block">
        <div class="brand-title">EXXEL TECHNOLOGY PTE LTD</div>
        <div class="brand-meta">
          1 Kaki Bukit Ave 3 KB-1 #03-07 Singapore 416087<br/>
          Tel: (65) 6743 4553 &nbsp; Fax: (65) 6743 6929<br/>
          Email: sales@exxeltech.com &nbsp; Website: www.exxeltech.com<br/>
          Company/GST Reg no: 199407327W
        </div>
      </div>
      <div class="doc-meta">
        <table>
          <tr><td>Page</td><td>1 of <%= pages || 1 %></td></tr>
          <tr><td>DO No</td><td><%= doNo %></td></tr>
          <tr><td>Date</td><td><%= date %></td></tr>
          <tr><td>PO No</td><td><%= poNo %></td></tr>
          <tr><td>Terms</td><td><%= terms %></td></tr>
          <tr><td>Salesperson</td><td><%= salesperson %></td></tr>
        </table>
      </div>
    </div>

    <div class="two-col">
      <div class="card">
        <div class="t">Deliver To</div>
        <div class="v"><%= deliverTo.name %>\n<%= deliverTo.address %></div>
      </div>
      <div class="card">
        <div class="t">Attn</div>
        <div class="v"><%= attn %></div>
      </div>
    </div>

    <div class="title">Delivery Order</div>
  </div>
</header>

<footer>
  <div class="page">
    <div class="footline">
      <div>Goods received by: <strong><%= companyName %></strong></div>
      <div>DO No: <%= doNo %></div>
    </div>
  </div>
</footer>

<main class="page">
  <table class="items">
    <thead>
      <tr>
        <th class="center">No.</th>
        <th class="center">Pos</th>
        <th>Barcode</th>
        <th class="right">Qty</th>
        <th>Project Nr</th>
        <th>Item</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <% items.forEach((it) => { %>
        <tr>
          <td class="center"><%= it.pos %></td>
          <td class="center"><%= it.posCode || it.pos %></td>
          <td>
            <% if (it.barcodeDataUri) { %>
              <img src="<%= it.barcodeDataUri %>" style="height:32px;"/><br/>
            <% } %>
            <%= it.barcode || "" %>
          </td>
          <td class="right"><%= it.qty %></td>
          <td><%= it.projectNr %></td>
          <td><%= it.itemCode %></td>
          <td><%= it.description %></td>
        </tr>
      <% }) %>
    </tbody>
  </table>

  <div class="sign-row">
    <div class="sign-box">
      <div class="line">Recipient's Signature & Company Stamp</div>
      <div><%= deliverTo.name %></div>
    </div>
    <div class="sign-box">
      <div class="line">Authorised Signatory</div>
      <div><%= companyName %></div>
    </div>
  </div>
</main>
</body>
</html>
